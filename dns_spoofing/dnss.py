#! /usr/bin/env python

import json

from dns_spoofing import DNSSpoofing

def load_hosts_from_file(path):
    with open(path) as config_json:
        return json.load(config_json)

def create_args_parser():
    parser = argparse.ArgumentParser(description = 'DNS Spoofing script.', usage='dnss [OPTIONS ...]')
    parser.add_argument('-p', '--hosts-path', dest = 'hosts_path', help = 'path to json hosts file', required = False)

    return parser

def main():
    DEFAULT_HOSTS_PATH = "./hosts.json"
    
    parser = create_args_parser()
    args = parser.parse_args()

    hosts = None
    if args.hosts_path != None:
        hosts = load_hosts_from_file(args.hosts_path)
    else:
        hosts = load_hosts_from_file(DEFAULT_HOSTS_PATH)

    if hosts != None:
        spoofer = DNSSpoofing(hosts)
        spoofer.run()

    pass

if __name__ == "__main__":
    main()