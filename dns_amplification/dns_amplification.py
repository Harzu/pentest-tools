from scapy.all import *

query_types = ["ANY", "A","AAAA","CNAME","MX","NS","PTR","CERT","SRV","TXT", "SOA"]
dns_destination_addresses = ["8.8.8.8"]
ttl = 128

def main():
    query_dns_name = raw_input("input link name for query \n >")
    ip_destination = raw_input("input destination ip \n >")
    
    packet_num = 0
    for i in range(dns_destination):
        for j in range(query_types):
            packet_num += 1

            packet = IP(
                src = ip_destination,
                dst = dns_destination_addresses[i],
                ttl = ttl
            )/UDP()/DNS(
                rd = 1,
                qr = DNQR(qname = query_name, qtype = query_types[j])
            )

            try:
                query = sr1(packet, verbose = False, timeout = 8)
            except:
                print("Error send packet #{}".format(packet_num))
    pass

if __name__ == "__main__":
    main()