#! /usr/bin/env python

import json
import argparse

from scapy.all import *
from dns_amplification import DNSAmplification

def load_config(path):
    with open(path) as config_json:
        return json.load(config_json)

def create_args_parser():
    parser = argparse.ArgumentParser(description = 'DNS Amplification script.', usage='dnsa [OPTIONS ...]')
    parser.add_argument('-c', '--config', dest = 'config_path', help = 'path to json config file', required = False)

    return parser

def main():
    parser = create_args_parser()
    args = parser.parse_args()
    
    if args.config_path != None:
        config = load_config(args.config_path)
        instance = DNSAmplification(config)
        instance.run()
    else:
        print("config path not found. Please use dnsa -h for see help")

    pass

if __name__ == "__main__":
    main()
